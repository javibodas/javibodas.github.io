<!DOCTYPE html>
<html lang="es"> 
<head>
     <title>Javi Blog</title>
    
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Blog Template">
    <meta name="author" content="Xiaoying Riley at 3rd Wave Media">    
    <link rel="shortcut icon" href="favicon.ico"> 
    
    <!-- FontAwesome JS-->
    <script defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/agate.min.css">
    <link id="theme-style" rel="stylesheet" href="/assets/css/theme.css">
    <link rel="stylesheet" href="/assets/css/blog.css">
    <link rel="stylesheet" href="/assets/css/post.css">
</head> 

<body>
    
    <header class="header text-center">
		<!-- Load by react in header-post.js-->
	</header>
    
    <div class="main-wrapper">
    	<div class="row desktop">
    		<div class="col-lg-9 col-12">
			    <article class="blog-post px-3 py-5 p-md-5">
				    <div class="container">
					    <header class="blog-post-header">
						    <h2 class="title mb-2">Aplicación Spring Boot en Heroku. Instalación y Configuración.</h2>
						    <!--<div class="meta mb-3"><i class="fas fa-hashtag"></i>blockchain</div>-->
						    <div class="meta mb-3"><span class="date">Publicado 12/03/2020</span><!--<span class="time">5 min read</span><span class="comment">--></div>
					    </header>
					    
					    <div class="blog-post-body">
					    	<p><i>Nota: A lo largo del post hago referencia a conceptos en los que no profundizaré pero si añadiré enlaces en los que se podrá entender el funcionamiento.</i></p>
						    <p>El objetivo de este post es mostrar los <label class="step">pasos</label> a seguir para generar desde cero una API REST desarrollada con el framework <b><a href="https://www.spring.io/projects/spring-boot">Spring Boot</a></b> y desplegarlo en los servidores de <b><a href="https://www.heroku.com">Heroku</a></b>. La API accederá a una BBDD basada en <a href="https://www.postgresql.org"><b>PostgreSQL</b></a>. De esta manera podremos disponer de  nuestra propia API complemtamente funcional sin necesidad de poseer un servidor físico.</p>
						    <p>Antes de nada deberemos darnos de alta en la web de <a href="https://www.heroku.com/login"><b>Heroku</b></a> para poder desplegar en sus servidores tanto la API como la BBDD <a class="step">(1)</a>.</p>
						    <p>Además, para poder desarrollar y testear nuestra aplicación, será necesario tener instalado un IDE con el que podamos ejecutarla en local. En esta guía utilizaremos Eclipse y Windows.</p>
						    <p>El framework <i><b>Spring Boot</b></i> en su versión <b><i>2</b></i> <a href="https://docs.spring.io/spring-boot/docs/2.0.3.RELEASE/reference/html/getting-started-system-requirements.html"><b>requiere</b></a> que se encuentre instalada la versión <i><b>8</b></i> o <i><b>9</b></i> de <i><b>Java</b></i>. Por lo que deberemos comprobar la versión instalada en nuestra máquina desde la consola de comandos:</p>
						    <pre><code class="hljs shell">C:\Users\javier> java -version<br>java version "1.8.0_131"<br>Java(TM) SE Runtime Environment (build 1.8.0_131-b11)<br>Java HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode)</code></pre>
						    <p>Si no tenemos instalada dicha versión podremos descargarnosla en la siguiente <a href="https://www.java.com/es"><b>url</b></a>.</p>
						    <p>Cuando tengamos instalada la versión adecuada de Java, instalaremos el IDE. Para ello accederemos a la siguiente <a href="https://www.spring.io/tools"><b>web de descarga</b></a> de Spring, y descargaremos la siguiente herramienta <a class="step">(2)</a>:</p>
						    <img src="/assets/images/blog/spring-plugin.png">
						    <p>El fichero que nos habremos descargado en el caso de Windows será un .jar, el cúal contendrá una carpeta donde se encontrará el ejecutador del IDE (SpringToolSuite4). Este IDE es una versión de Eclipse que contiene herramientas de Spring instaladas. Al ejecutarlo, nos solicitará establecer la carpeta donde se encontrarán los proyectos con los que trabajaremos. Por defecto la carpeta es generada en un directorio del usuario (C:\Users\javier\Documents\workspace-spring-tool-suite-v...).</p>
						    <p>Una vez tengamos nuestro entorno de desarrollo configurado, pasaremos a generar el proyecto Spring. Esto es bastante sencillo gracias a la herramienta <a href="https://start.spring.io"><b>Spring Initializr</b></a>. Con esta herramienta podremos generar la estructura básica de un proyecto Spring:</p>
						    <img src="/assets/images/blog/spring-initialzr-default.png">
						    <p>En el formulario que nos presenta la herramienta, indicaremos tanto el nombre como las dependencias de nuestro proyecto. Como hemos comentado al principio, nuestra aplicación será una API que consultará contra una BBDD PostgreSQL. Por ello deberemos añadir una dependencia para la conexión con PostgreSQL y una dependencia para el manejo de <a href="https://es.wikipedia.org/wiki/Java_Persistence_API"><b>JPAs</b></a> con Hibernate desde Java. Además añadiremos la librería Web que nos proporcionará anotaciones para desarrollar la API. Estas dependencias son las que apareceren en la siguiente imagen:</p>
						    <img src="/assets/images/blog/spring-initialzr-filled.png">
						    <br> 
						    <p>Al pulsar el botón <b><i>Generate</i></b> nos descargaremos el proyecto con toda la estructura dentro de un fichero .zip. Deberemos descompromirlo e importar dicha carpeta en nuestro IDE: <b><i>File > Import...</i></b>:</p>
						    <img src="/assets/images/blog/import-existing-maven-project.png">
						    <br>
						    <p>Con el proyecto importado generaremos un controlador simple que recoja la llamada al path "/" de nuestra API. En el paquete <b><i>com.example.api</i></b> del proyecto crearemos un paquete llamado <b><i>controllers</i></b> y en el generaremos una clase Java llamada <b><i>HomeController</i></b> con el siguiente código:</p>
						    <pre><code class="hljs java">package com.example.api.controllers;<br><br>import org.springframework.web.bind.annotation.RequestMapping;<br>import org.springframework.web.bind.annotation.RestController;<br>import org.springframework.web.bind.annotation.ResponseBody;<br><br>@RestController<br>public class HomeController {<br><br>&nbsp;@RequestMapping(value="/articles", method=RequestMethod.GET)</t></br>&nbsp;@ResponseBody<br>&nbsp;public String getHome() {<br>&nbsp;&nbsp;return ("Hello World");<br>&nbsp;}<br>}</code></pre>
						    <p>Ejeuctamos la aplicación desde la pestaña <b><i>Boot Dashboard</i></b> y si accedemos a la url <b><i>localhost:8080/</i></b> debería devolvernos el texto "Hello World".</p>
						    <img src="/assets/images/blog/launch-spring-api-local.png">
						    <br>
						    <img src="/assets/images/blog/hello-api-spring-local.png">
						    <p>Con esto tendríamos nuestra API funcionando en local , por lo que el siguiente paso sería desplegarla en Heroku. Para esto tendremos que hacer uso del sistema de control de versiones <a href="https://git-scm.com/downloads"><b>git</b></a>. En el caso de Windows, nos descagaremos un asistente que nos instalará el sistema y nos proporcionará una consola de comandos (Git Bash).</p>
						    <p>Una vez la tengamos instalada ejecutaremos el siguiente comando en la carpeta del proyecto desde la consola git bash:</p>
						    <pre><code class="hljs shell">$ git init<br>Inicializado repositorio Git vacío en C:\Users\javier\Documents\workspace-spring-tool-suite-v..\api\.git</code></pre>
						    <p>Tras esto deberemos instalar el cliente de Heroku que podremos descargar de la siguiente <a href="https://devcenter.heroku.com/articles/heroku-cli#download-and-install"><b>url</b></a>. Para windows deberemos ejecutar el .exe descargado y una vez finalizada la instalación deberíamos poder hacer uso del comando heroku desde la consola:</p>
						    <pre><code class="hljs shell">$ heroku<br>CLI to interact with Heroku<br><br><b>VERSION</b><br>&nbsp;heroku/7.38.0 win32-x64 node-v12.13.0<br><br><b>USAGE</b><br>&nbsp;$ heroku [COMMAND]</code></pre>
						    <p> Nos loguearemos con el usuario de Heroku para asociar la cuenta a la máquina:</p>
						    <pre><code class="hljs shell">$ heroku login</code></pre>
						    <p>Y con el comando funcionando, daremos de alta la aplicación en Heroku. Para ello ejecutaremos el siguiente comando en la carpeta del proyecto:</p>
						    <pre><code class="hljs shell">$ heroku create api<br>Creating api… done<br>https://api.herokuapp.com/ | https://git.heroku.com/api.git</code></pre>
						    <p>Si observamos el resultado del comando veremos dos urls, una corresponde al punto de acceso de la aplicación y la otra al repositorio git de Heroku donde se almacenará nuestra aplicación.</p>
						    <p>Si accedemos a nuestra cuenta en la web de Heroku veremos que se nos habrá añadido un registro en el listado de aplicaciones:</p>
						    <img src="/assets/images/blog/heroku-list-apps.png">
						    <p>Desde la propia web podremos gestionar cierta información de la aplicación y añadir add-ons (como la base de datos).</p> 
						    <p>Antes de desplegar la apliación, comprobaremos las rutas de los repositorios git desde la carpeta de nuestra aplicación:</p>
						    <pre><code class="hljs shell">$ git remote<br>heroku  https://git.heroku.com/api.git (fetch)<br>heroku  https://git.heroku.com/api.git (push)</code></pre>
						    <p>En caso de no devolver nada deberemos añadir la url del repositorio git que vimos antes con el comando <i>git remote add heroku https://git.heroku.com/api.git</i>. Finalmente solo tendremos que desplegar en el repositorio la aplicación con el comando:</p>
						    <pre><code class="hljs shell">$ git push heroku master</code></pre>
						    <p>Antes de acceder a la API, podemos utilizar un comando muy útil de Heroku, que es 'logs'. Con este comando podemos visualizar el log de la aplicación: 
						    <pre><code class="hljs shell">$ heroku logs -a api</code></pre>
						    <p>En la siguiente <a href="https://devcenter.heroku.com/articles/heroku-cli-commands#heroku-logs"><b>url</b></a> podéis ver distintos parámetros para el comando.</p> 	
						    <p>Cuando hayamos comprobado que no hay ningún error en el log, podremos acceder a la API a través de la url que nos devolvió la herramienta en la creación de la misma:</p>
						    <img src="/assets/images/blog/hello-api-heroku-spring-deployed.png">
						    <p>Hasta aquí llegaría esta primera parte en la que se muestra como instalar el entorno de desarrollo (2). En el siguiente post configuraremos la base de datos a la que accederá la API. </p>
					    </div>
				    </div><!--//container-->
			    </article>
			</div>
			<!--<div class="col-lg-3 col-12 right-bar">
				<div class="px-3 p-md-5">
					<div class="section-inner">
						<div class="heading py-2"><h4>Articulos</h4>
						</div>
						<ul class="article-list">
						<!-- Load by react in articles.js-->
						<!--</ul>
					</div>
				</div>
			</div>-->
		</div> <!--//DESKTOP-->
	    <footer class="footer text-center py-2 theme-bg-dark">
		   
	        <!--/* This template is released under the Creative Commons Attribution 3.0 License. Please keep the attribution link below when using for your own project. Thank you for your support. :) If you'd like to use the template without the attribution, you can buy the commercial license via our website: themes.3rdwavemedia.com */-->
                <small class="copyright">Designed with <i class="fas fa-heart" style="color: #fb866a;"></i> by <a href="http://themes.3rdwavemedia.com" target="_blank">Xiaoying Riley</a> for developers</small>
		   
	    </footer>
    
    </div><!--//main-wrapper-->
    

    <!-- Javascript -->          
    <script src="/assets/plugins/jquery-3.3.1.min.js"></script> 
    <script src="/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    
    <!-- Page Specific JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>

    <!-- ReactJs-->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://unpkg.com/react@16/umd/react.production.min.js" crossorigin></script>
  	<script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js" crossorigin></script>

    <!-- Custom JS -->
    <script type="text/babel" src="/assets/js/components/header.js"></script>
    <script type="text/babel" src="/assets/js/components/header-post.js"></script>
    <script src="/assets/js/blog.js"></script>

</body>
</html> 

